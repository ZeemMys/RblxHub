local Rayfield = loadstring(game:HttpGet('https://sirius.menu/rayfield'))()

local Window = Rayfield:CreateWindow({
    Name = "DucWare — Grow A Garden",
    Icon = 0, -- Icon in Topbar. Can use Lucide Icons (string) or Roblox Image (number). 0 to use no icon (default).
    LoadingTitle = "Wait a minute, the script is loading",
    LoadingSubtitle = "by DucMagic$",
    Theme = "Amethyst", -- Check https://docs.sirius.menu/rayfield/configuration/themes
 
    DisableRayfieldPrompts = false,
    DisableBuildWarnings = false, -- Prevents Rayfield from warning when the script has a version mismatch with the interface
 
    ConfigurationSaving = {
       Enabled = true,
       FolderName = Duckian, -- Create a custom folder for your hub/game
       FileName = "Duckian Hub"
    },
 
    Discord = {
       Enabled = true, -- Prompt the user to join your Discord server if their executor supports it
       Invite = "PnHj485p", -- The Discord invite code, do not include discord.gg/. E.g. discord.gg/ ABCD would be ABCD
       RememberJoins = false -- Set this to false to make them join the discord every time they load it up
    },
 
    KeySystem = true, -- Set this to true to use our key system
    KeySettings = {
       Title = "Go Ask Him",
       Subtitle = "Key System",
       Note = "Get Key", -- Use this to tell the user how to get a key
       FileName = "Key", -- It is recommended to use something unique as other scripts using Rayfield may overwrite your key file
       SaveKey = true, -- The user's key will be saved, but if you change the key, they will be unable to use your script
       GrabKeyFromSite = false, -- If this is true, set Key below to the RAW site you would like Rayfield to get the key from
       Key = {"ducmagic"} -- List of keys that will be accepted by the system, can be RAW file links (pastebin, github etc) or simple strings ("hello","key22")
    }
 })

Rayfield:Notify({
   Title = "XIN THÔNG BÁO",
   Content = "PHIÊN BẢN FREE",
   Duration = 5,
   Image = "0",
})

local MainTab = Window:CreateTab("Main", 4483362458) -- Title, Image
local PlayerTab = Window:CreateTab("Player", 4483362458) -- Title, Image
local FunnyTab = Window:CreateTab("Fun And Code", 4483362458)

------MAIN--------
local Paragraph = MainTab:CreateParagraph({Title = "Thanks For Using", Content = "Contact 0856469268"})

MainTab:CreateToggle({
    Name = "Auto Harvest",
    CurrentValue = false,
    Callback = function(Value)
        _G.AutoHarvestUniversal = Value

        if not Value then
            print("⛔ Đã tắt Auto Harvest")
            return
        end

        task.spawn(function()
            local Players = game:GetService("Players")
            local player = Players.LocalPlayer
            local hrp = player.Character:WaitForChild("HumanoidRootPart")

            -- Hàm teleport trực tiếp tới vị trí của cây
            local function teleTo(part)
                if not part or not part:IsA("BasePart") then return end
                local goalPosition = part.Position + Vector3.new(0, 2.5, 0)  -- Đi lên trên phần để hái
                hrp.CFrame = CFrame.new(goalPosition)  -- Teleport đến vị trí của trái cây/cây
                task.wait(0.5)
            end

            local function getMyFarm()
                local allPlayers = Players:GetPlayers()
                table.sort(allPlayers, function(a, b) return a.Name < b.Name end)
                local myIndex = table.find(allPlayers, player)
                if not myIndex then return nil end

                local farmFolder = workspace:FindFirstChild("Farm")
                if not farmFolder then return nil end

                local farms = farmFolder:GetChildren()
                table.sort(farms, function(a, b) return a.Name < b.Name end)

                return farms[myIndex]
            end

            while task.wait(1.2) do
                if not _G.AutoHarvestUniversal then break end
                pcall(function()
                    local myFarm = getMyFarm()
                    if not myFarm then return end

                    local important = myFarm:FindFirstChild("Important")
                    local plants = important and important:FindFirstChild("Plants_Physical")
                    if not plants then return end

                    for _, plant in ipairs(plants:GetChildren()) do
                        if not _G.AutoHarvestUniversal then return end

                        -- Nhổ cây (như carrot, tre)
                        local prompt = plant:FindFirstChildWhichIsA("ProximityPrompt", true)
                        if prompt then
                            local mainPart = plant:IsA("Part") and plant or plant:FindFirstChildWhichIsA("BasePart")
                            if mainPart then
                                teleTo(mainPart)  -- Teleport đến cây cần hái
                                fireproximityprompt(prompt)
                                task.wait(0.4)  -- Đợi một chút để thực hiện hành động
                            end
                        end

                        -- Hái cây (như cherry, raspberry)
                        local fruitFolder = plant:FindFirstChild("Fruits")
                        if fruitFolder then
                            local growFolder = fruitFolder:FindFirstChild("Grow") or fruitFolder
                            for _, fruit in ipairs(growFolder:GetChildren()) do
                                if not _G.AutoHarvestUniversal then return end

                                if fruit:IsA("BasePart") or fruit:IsA("MeshPart") then
                                    local fruitPrompt = fruit:FindFirstChildWhichIsA("ProximityPrompt")
                                    if fruitPrompt then
                                        teleTo(fruit)  -- Teleport lên trái cây để hái
                                        fireproximityprompt(fruitPrompt)
                                        task.wait(0.4)  -- Đợi một chút để thực hiện hành động
                                    end
                                end
                            end
                        end
                    end
                end)
            end
        end)
    end,
})
------Funny------
local Button = FunnyTab:CreateButton({
   Name = "Click To See What Happen:)",
   Callback = function()
       local player = game.Players.LocalPlayer
       if player and player.Character then
           player.Character:BreakJoints() -- Reset nhân vật
       end
   end
})

FunnyTab:CreateToggle({
    Name = "Xoá Part (CHỜ BỐ MÀY XÍU)",
    CurrentValue = false,
    Callback = function(Value)
        if Value then
            print("Toggle 'Xoá Part' được bật")

            local seedStands = nil
            local sellStands = nil
            local gearStands = nil
            local petStands = nil
            local questModel = nil

            -- Tìm các stand mô hình
            for _, obj in ipairs(workspace:GetDescendants()) do
                if obj:IsA("Model") then
                    if obj.Name == "Seed Stands" then
                        seedStands = obj
                    elseif obj.Name == "Sell Stands" then
                        sellStands = obj
                    elseif obj.Name == "Gear Stands" then
                        gearStands = obj
                    elseif obj.Name == "Pet Stand" then
                        petStands = obj
                    elseif obj.Name == "Quest Stand" then
                        questModel = obj
                    end
                end
            end

            -- Các tên Part cần xóa
            local namesToDelete = {
                "Part",
                "Crooked Plank",
                "Crooked Plank2",
                "Shop Stand",
                "Gear Part",
                "Pet Part",
                "Quest Part"
            }

            -- Hàm xóa các part trong mô hình
            local function deletePartsFromModel(model)
                for _, obj in ipairs(model:GetDescendants()) do
                    if obj:IsA("BasePart") and table.find(namesToDelete, obj.Name) then
                        obj.Anchored = false
                        print("Đang xóa part: " .. obj.Name)
                        obj:Destroy()
                    end
                end
            end

            -- Xóa các phần trong từng Stand
            if seedStands then deletePartsFromModel(seedStands) end
            if sellStands then deletePartsFromModel(sellStands) end
            if gearStands then deletePartsFromModel(gearStands) end
            if petStands then deletePartsFromModel(petStands) end
            if questModel then deletePartsFromModel(questModel) end

            -- GIỮ LẠI: Xử lý các Farm Folder bên trong workspace.Farm
            local farmFolder = workspace:FindFirstChild("Farm")
            if farmFolder and farmFolder:IsA("Folder") then
                for _, singleFarm in ipairs(farmFolder:GetChildren()) do
                    if singleFarm:IsA("Folder") then
                        print("Đang kiểm tra folder: " .. singleFarm.Name)

                        -- Kiểm tra nếu có mô hình Decoration và xóa Farm Fence nếu có
                        local decorationModel = singleFarm:FindFirstChild("Decoration")
                        if decorationModel then
                            print("Tìm thấy Decoration trong folder: " .. singleFarm.Name)
                            local foundFarmFence = false
                            for _, desc in ipairs(decorationModel:GetDescendants()) do
                                if desc:IsA("Model") and desc.Name == "Farm Fence" then
                                    print("Đang xóa Farm Fence trong folder: " .. singleFarm.Name)
                                    desc:Destroy()
                                    foundFarmFence = true
                                end
                            end
                            if not foundFarmFence then
                                print("Không tìm thấy Farm Fence trong Decoration của folder: " .. singleFarm.Name)
                            end
                        else
                            print("Không tìm thấy Decoration trong folder: " .. singleFarm.Name)
                        end

                        -- Xóa Grown_Sign trong mỗi folder con của Farm
                        local foundGrownSign = false
                        for _, item in ipairs(singleFarm:GetDescendants()) do
                            if (item:IsA("BasePart") or item:IsA("Model")) then
                                if item.Name == "Grown_Sign" then
                                    print("Đang xóa Grown_Sign trong folder: ", singleFarm.Name)
                                    item:Destroy()
                                    foundGrownSign = true
                                end
                            end
                        end
                        if not foundGrownSign then
                            print("Không tìm thấy Grown_Sign trong folder: " .. singleFarm.Name)
                        end
                    end
                end
            else
                warn("Không tìm thấy folder Farm trong workspace hoặc không phải là Folder")
            end
        end
    end
})

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local codeRemote = ReplicatedStorage:WaitForChild("GameEvents"):WaitForChild("ClaimableCodeService")

-- Danh sách các mã cần nạp
local listOfCodes = {
    "LUNARGLOW10", -- thay mã hợp lệ vào đây
}

FunnyTab:CreateButton({
    Name = "Redeem All Codes",
    Callback = function()
        for _, code in ipairs(listOfCodes) do
            codeRemote:FireServer(code)  -- Gửi mã đến server
            task.wait(0.3)  -- Chờ giữa mỗi lần gửi để tránh lag
        end
    end
})
------PLAYER---------
-- WalkSpeed Toggle + Slider
local WalkEnabled = false
local DefaultWalkSpeed = 16
local WalkSpeedValue = DefaultWalkSpeed

PlayerTab:CreateToggle({
    Name = "Chạy Nhanh",
    CurrentValue = false,
    Callback = function(Value)
        WalkEnabled = Value
        local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.WalkSpeed = Value and WalkSpeedValue or DefaultWalkSpeed
        end
    end,
})

PlayerTab:CreateSlider({
    Name = "WalkSpeed",
    Range = {16, 200},
    Increment = 1,
    Suffix = "Speed",
    CurrentValue = DefaultWalkSpeed,
    Callback = function(Value)
        WalkSpeedValue = Value
        if WalkEnabled then
            local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = Value
            end
        end
    end,
})

-- JumpPower Toggle + Slider
local JumpEnabled = false
local DefaultJumpPower = 50
local JumpPowerValue = DefaultJumpPower

PlayerTab:CreateToggle({
    Name = "Sức Mạnh Nhảy",
    CurrentValue = false,
    Callback = function(Value)
        JumpEnabled = Value
        local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid.JumpPower = Value and JumpPowerValue or DefaultJumpPower
        end
    end,
})

PlayerTab:CreateSlider({
    Name = "JumpPower",
    Range = {50, 500},
    Increment = 1,
    Suffix = "Power",
    CurrentValue = DefaultJumpPower,
    Callback = function(Value)
        JumpPowerValue = Value
        if JumpEnabled then
            local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = Value
            end
        end
    end,
})

-- Auto Aimbot
local AimbotEnabled = false
local AimbotFOV = 100
local currentTarget = nil
local marker = nil

-- Hàm tạo chấm xanh
local function createMarker(targetPart)
    if marker then marker:Destroy() end

    marker = Instance.new("BillboardGui")
    marker.Name = "AimbotMarker"
    marker.AlwaysOnTop = true
    marker.Size = UDim2.new(0, 12, 0, 12)
    marker.Adornee = targetPart
    marker.Parent = targetPart

    local dot = Instance.new("Frame")
    dot.Size = UDim2.new(1, 0, 1, 0)
    dot.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    dot.BorderSizePixel = 0
    dot.BackgroundTransparency = 0.1
    dot.Parent = marker
end

local function removeMarker()
    if marker then
        marker:Destroy()
        marker = nil
    end
end

-- Hàm tìm đối tượng gần nhất trong FOV
local function GetNearestTarget()
    local players = game:GetService("Players")
    local localPlayer = players.LocalPlayer
    local camera = workspace.CurrentCamera
    local nearest = nil
    local shortestDistance = AimbotFOV

    for _, player in ipairs(players:GetPlayers()) do
        if player ~= localPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local pos, onScreen = camera:WorldToViewportPoint(player.Character.HumanoidRootPart.Position)
            if onScreen then
                local distance = (Vector2.new(pos.X, pos.Y) - Vector2.new(camera.ViewportSize.X/2, camera.ViewportSize.Y/2)).Magnitude
                if distance < shortestDistance then
                    shortestDistance = distance
                    nearest = player
                end
            end
        end
    end

    return nearest
end

local aimbotConnection
local function enableAimbot()
    aimbotConnection = game:GetService("RunService").RenderStepped:Connect(function()
        if not AimbotEnabled then return end

        local target = GetNearestTarget()
        if target and target.Character and target.Character:FindFirstChild("HumanoidRootPart") then
            local camera = workspace.CurrentCamera
            -- Tạo một vị trí mới camera sẽ luôn hướng về mục tiêu
            local targetPosition = target.Character.HumanoidRootPart.Position
            local cameraPosition = camera.CFrame.Position
            local direction = (targetPosition - cameraPosition).unit
            -- Điều chỉnh camera để luôn nhìn vào mục tiêu mà không thay đổi góc nhìn của người chơi
            camera.CFrame = CFrame.new(cameraPosition, cameraPosition + direction)
            
            if target ~= currentTarget then
                currentTarget = target
                createMarker(target.Character.HumanoidRootPart)
            end
        else
            -- Không có mục tiêu
            if currentTarget then
                currentTarget = nil
                removeMarker()
            end
        end
    end)
end

local function disableAimbot()
    if aimbotConnection then
        aimbotConnection:Disconnect()
        aimbotConnection = nil
    end

    -- Reset camera và loại bỏ marker
    currentTarget = nil
    removeMarker()

    local cam = workspace.CurrentCamera
    if cam then
        cam.CameraType = Enum.CameraType.Custom
    end
end

PlayerTab:CreateToggle({
    Name = "Auto Aimbot",
    CurrentValue = false,
    Callback = function(Value)
        AimbotEnabled = Value
        if Value then
            enableAimbot()
        else
            disableAimbot()
        end
    end,
})

PlayerTab:CreateSlider({
    Name = "Aimbot FOV",
    Range = {20, 500},
    Increment = 10,
    Suffix = "px",
    CurrentValue = AimbotFOV,
    Callback = function(Value)
        AimbotFOV = Value
    end,
})

local UIS = game:GetService("UserInputService")
local RS = game:GetService("RunService")
local flyConnection
local velocity
local flySpeed = 50
local flying = false

local function startFlying()
    local char = game.Players.LocalPlayer.Character
    local hrp = char and char:FindFirstChild("HumanoidRootPart")
    if not hrp then return end

    velocity = Instance.new("BodyVelocity")
    velocity.MaxForce = Vector3.new(1e5, 1e5, 1e5)
    velocity.Velocity = Vector3.zero
    velocity.Parent = hrp

    flying = true

    flyConnection = RS.RenderStepped:Connect(function()
        local cam = workspace.CurrentCamera
        local moveDirection = Vector3.zero

        if UIS:IsKeyDown(Enum.KeyCode.W) then
            moveDirection += cam.CFrame.LookVector
        end
        if UIS:IsKeyDown(Enum.KeyCode.S) then
            moveDirection -= cam.CFrame.LookVector
        end
        if UIS:IsKeyDown(Enum.KeyCode.A) then
            moveDirection -= cam.CFrame.RightVector
        end
        if UIS:IsKeyDown(Enum.KeyCode.D) then
            moveDirection += cam.CFrame.RightVector
        end
        if UIS:IsKeyDown(Enum.KeyCode.Space) then
            moveDirection += Vector3.new(0, 1, 0)
        end
        if UIS:IsKeyDown(Enum.KeyCode.LeftControl) then
            moveDirection -= Vector3.new(0, 1, 0)
        end

        if moveDirection.Magnitude > 0 then
            velocity.Velocity = moveDirection.Unit * flySpeed
        else
            velocity.Velocity = Vector3.zero
        end
    end)
end

local function stopFlying()
    flying = false
    if flyConnection then flyConnection:Disconnect() end
    if velocity then velocity:Destroy() end
end

-- Toggle Fly
PlayerTab:CreateToggle({
    Name = "Fly",
    CurrentValue = false,
    Callback = function(Value)
        FlyEnabled = Value
        if Value then
            startFlying()
        else
            stopFlying()
        end
    end,
})

-- Fly Speed Slider
PlayerTab:CreateSlider({
    Name = "Fly Speed",
    Range = {10, 300},
    Increment = 5,
    Suffix = "stud/s",
    CurrentValue = flySpeed,
    Callback = function(Value)
        flySpeed = Value
        if flying then
            bodyVelocity.Velocity = Vector3.new(0, FlySpeed, 0)
        end
    end,
})

local ESPEnabled = false
local ESPObjects = {}

function createESP(player)
    if player == game.Players.LocalPlayer then return end
    local character = player.Character
    if not character then return end

    local box = Instance.new("BoxHandleAdornment")
    box.Name = "ESPBox"
    box.Size = Vector3.new(2, 5, 1)
    box.Color3 = Color3.fromRGB(0, 255, 0)
    box.Transparency = 0.5
    box.Adornee = character:FindFirstChild("HumanoidRootPart")
    box.AlwaysOnTop = true
    box.ZIndex = 5
    box.Parent = character

    local nameTag = Instance.new("BillboardGui")
    nameTag.Name = "ESPName"
    nameTag.Size = UDim2.new(0, 100, 0, 40)
    nameTag.StudsOffset = Vector3.new(0, 3, 0)
    nameTag.Adornee = character:FindFirstChild("Head")
    nameTag.AlwaysOnTop = true
    nameTag.Parent = character

    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 1, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.Text = player.Name
    nameLabel.TextColor3 = Color3.new(1, 1, 1)
    nameLabel.TextScaled = true
    nameLabel.Font = Enum.Font.SourceSansBold
    nameLabel.Parent = nameTag

    ESPObjects[player] = {box, nameTag}
end

function removeESP(player)
    if ESPObjects[player] then
        for _, v in pairs(ESPObjects[player]) do
            if v then v:Destroy() end
        end
        ESPObjects[player] = nil
    end
end

function updateESP()
    for _, player in pairs(game.Players:GetPlayers()) do
        if ESPEnabled then
            if player.Character and not ESPObjects[player] then
                createESP(player)
            end
        else
            removeESP(player)
        end
    end
end

-- Toggle ESP
PlayerTab:CreateToggle({
    Name = "Bật/Tắt ESP",
    CurrentValue = false,
    Callback = function(Value)
        ESPEnabled = Value
        updateESP()
    end,
})

-- Theo dõi người chơi mới
game.Players.PlayerAdded:Connect(function(player)
    player.CharacterAdded:Connect(function()
        wait(1)
        if ESPEnabled then
            createESP(player)
        end
    end)
end)

-- Xoá ESP khi người chơi rời
game.Players.PlayerRemoving:Connect(function(player)
    removeESP(player)
end)
